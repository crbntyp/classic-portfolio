@use '../abstracts/variables' as *;

/**
 * Main Navigation Component
 * Primary site navigation with animated popup menu
 */

@keyframes popIn {
    0% {
        transform: translate(0, 0) scale(0);
        opacity: 0;
    }
    100% {
        transform: translate(var(--random-x), var(--random-y)) scale(1);
        opacity: 1;
    }
}

@keyframes popOut {
    0% {
        transform: translate(var(--random-x), var(--random-y)) scale(1);
        opacity: 1;
    }
    100% {
        transform: translate(var(--exit-x), var(--exit-y)) scale(0);
        opacity: 0;
    }
}

@keyframes slowRotate {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

.main-nav {
    position: relative;

    &__popup {
        position: fixed;
        pointer-events: none;
        z-index: 9999;
    }

    &__item {
        position: fixed;
        width: 45px;
        height: 45px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: $color-white;
        text-decoration: none;
        transform: scale(0);
        opacity: 0;

        &:hover {
            //transform: translate(var(--random-x), var(--random-y)) scale(1.3) !important;
            //color: cyan;
        }

        // Animated blob background - using a wrapper element approach
        .blob-bg {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, white, $color-secondary);
            border-radius: 50%;
            z-index: -1;
            pointer-events: none;
            transform: translate(-50%, -50%);
            opacity: 0.6;
        }

        // Staggered animation when menu is active
        .main-nav__popup.active & {
            animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            pointer-events: auto;
        }

        // Stagger delays and unique blob animations for backgrounds
        .main-nav__popup.active &:nth-child(1) {
            animation-delay: 0s;
        }

        .main-nav__popup.active &:nth-child(1) .blob-bg {
            animation: menuBlobMorph1 8s ease-in-out 0.5s infinite;
        }

        .main-nav__popup.active &:nth-child(2) {
            animation-delay: 0.1s;
        }

        .main-nav__popup.active &:nth-child(2) .blob-bg {
            animation: menuBlobMorph2 9s ease-in-out 0.6s infinite;
        }

        .main-nav__popup.active &:nth-child(3) {
            animation-delay: 0.2s;
        }

        .main-nav__popup.active &:nth-child(3) .blob-bg {
            animation: menuBlobMorph3 10s ease-in-out 0.7s infinite;
        }

        .main-nav__popup.active &:nth-child(4) {
            animation-delay: 0.3s;
        }

        .main-nav__popup.active &:nth-child(4) .blob-bg {
            animation: menuBlobMorph1 9s ease-in-out 0.8s infinite;
        }

        .main-nav__popup.active &:nth-child(5) {
            animation-delay: 0.4s;
        }

        .main-nav__popup.active &:nth-child(5) .blob-bg {
            animation: menuBlobMorph2 8s ease-in-out 0.9s infinite;
        }

        // Exiting animation with staggered delays
        .main-nav__popup.exiting & {
            animation: popOut 0.5s cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards;
            pointer-events: none;
        }

        .main-nav__popup.exiting &:nth-child(1) {
            animation-delay: 0s;
        }

        .main-nav__popup.exiting &:nth-child(2) {
            animation-delay: 0.1s;
        }

        .main-nav__popup.exiting &:nth-child(3) {
            animation-delay: 0.2s;
        }

        .main-nav__popup.exiting &:nth-child(4) {
            animation-delay: 0.3s;
        }

        .main-nav__popup.exiting &:nth-child(5) {
            animation-delay: 0.4s;
        }

        i {
            display: block;
            font-size: 22px;
            position: relative;
            z-index: 1;
            animation: slowRotate 5s linear infinite;
        }
    }

    // Trigger icon
    &__trigger {
        cursor: pointer;
        position: relative;
        z-index: 10;

        i {
            display: block;
            transition: transform 0.3s ease;
            transform-origin: center center;
            position: relative;
        }

        &.active i {
            animation: rocketLaunch 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards,
                       rocketHover 2s ease-in-out 0.6s infinite;
        }


        &.returning i {
            animation: rocketReturn 3s ease-in forwards;
        }
    }
}

@keyframes rocketLaunch {
    0% {
        transform: translateY(0) rotate(0deg);
    }
    25% {
        transform: translateY(10px) rotate(-45deg);
    }
    50% {
        transform: translateY(10px) rotate(-45deg);
    }
    100% {
        transform: translateY(-20px) rotate(-45deg);
    }
}

@keyframes rocketHover {
    0%, 100% {
        transform: translateY(-20px) rotate(-45deg);
    }
    50% {
        transform: translateY(-25px) rotate(-45deg);
    }
}

@keyframes rocketReturn {
    0% {
        transform: translateY(-20px) rotate(-45deg);
        opacity: 1;
    }
    40% {
        transform: translateY(-120vh) rotate(-45deg);
        opacity: 1;
    }
    40.01% {
        transform: translateY(120vh) rotate(-45deg);
        opacity: 0;
    }
    50% {
        transform: translateY(120vh) rotate(-45deg);
        opacity: 1;
    }
    83% {
        transform: translateY(0) rotate(-45deg);
        opacity: 1;
    }
    100% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }
}

// Menu item blob morphing animations - staying circular and organic
@keyframes menuBlobMorph1 {
    0% {
        border-radius: 38% 62% 63% 37% / 41% 44% 56% 59%;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
    }
    14% {
        border-radius: 73% 27% 26% 74% / 55% 48% 52% 45%;
        transform: translate(-50%, -50%) scale(1.08) rotate(51deg);
    }
    28% {
        border-radius: 36% 64% 28% 72% / 76% 46% 54% 24%;
        transform: translate(-50%, -50%) scale(1.15) rotate(102deg);
    }
    42% {
        border-radius: 69% 31% 66% 34% / 42% 70% 30% 58%;
        transform: translate(-50%, -50%) scale(0.95) rotate(153deg);
    }
    56% {
        border-radius: 32% 68% 74% 26% / 67% 31% 69% 33%;
        transform: translate(-50%, -50%) scale(1.12) rotate(204deg);
    }
    70% {
        border-radius: 66% 34% 33% 67% / 36% 62% 38% 64%;
        transform: translate(-50%, -50%) scale(1.0) rotate(255deg);
    }
    84% {
        border-radius: 41% 59% 68% 32% / 71% 39% 61% 29%;
        transform: translate(-50%, -50%) scale(1.1) rotate(306deg);
    }
    100% {
        border-radius: 38% 62% 63% 37% / 41% 44% 56% 59%;
        transform: translate(-50%, -50%) scale(1) rotate(360deg);
    }
}

@keyframes menuBlobMorph2 {
    0% {
        border-radius: 42% 58% 70% 30% / 45% 67% 33% 55%;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
    }
    16% {
        border-radius: 78% 22% 35% 65% / 59% 41% 59% 41%;
        transform: translate(-50%, -50%) scale(1.13) rotate(58deg);
    }
    32% {
        border-radius: 29% 71% 68% 32% / 74% 36% 64% 26%;
        transform: translate(-50%, -50%) scale(0.92) rotate(116deg);
    }
    48% {
        border-radius: 61% 39% 39% 61% / 28% 72% 28% 72%;
        transform: translate(-50%, -50%) scale(1.16) rotate(174deg);
    }
    64% {
        border-radius: 35% 65% 72% 28% / 68% 45% 55% 32%;
        transform: translate(-50%, -50%) scale(1.05) rotate(232deg);
    }
    80% {
        border-radius: 73% 27% 44% 56% / 39% 68% 32% 61%;
        transform: translate(-50%, -50%) scale(0.97) rotate(290deg);
    }
    96% {
        border-radius: 47% 53% 61% 39% / 52% 48% 52% 48%;
        transform: translate(-50%, -50%) scale(1.08) rotate(348deg);
    }
    100% {
        border-radius: 42% 58% 70% 30% / 45% 67% 33% 55%;
        transform: translate(-50%, -50%) scale(1) rotate(360deg);
    }
}

@keyframes menuBlobMorph3 {
    0% {
        border-radius: 56% 44% 47% 53% / 62% 36% 64% 38%;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
    }
    12% {
        border-radius: 34% 66% 72% 28% / 43% 71% 29% 57%;
        transform: translate(-50%, -50%) scale(1.11) rotate(-43deg);
    }
    24% {
        border-radius: 71% 29% 31% 69% / 68% 48% 52% 32%;
        transform: translate(-50%, -50%) scale(0.94) rotate(-86deg);
    }
    36% {
        border-radius: 43% 57% 65% 35% / 37% 58% 42% 63%;
        transform: translate(-50%, -50%) scale(1.14) rotate(-129deg);
    }
    48% {
        border-radius: 68% 32% 39% 61% / 72% 34% 66% 28%;
        transform: translate(-50%, -50%) scale(1.02) rotate(-172deg);
    }
    60% {
        border-radius: 37% 63% 58% 42% / 29% 67% 33% 71%;
        transform: translate(-50%, -50%) scale(0.96) rotate(-215deg);
    }
    72% {
        border-radius: 64% 36% 74% 26% / 54% 41% 59% 46%;
        transform: translate(-50%, -50%) scale(1.13) rotate(-258deg);
    }
    84% {
        border-radius: 48% 52% 34% 66% / 69% 52% 48% 31%;
        transform: translate(-50%, -50%) scale(1.04) rotate(-301deg);
    }
    96% {
        border-radius: 59% 41% 55% 45% / 44% 61% 39% 56%;
        transform: translate(-50%, -50%) scale(0.98) rotate(-344deg);
    }
    100% {
        border-radius: 56% 44% 47% 53% / 62% 36% 64% 38%;
        transform: translate(-50%, -50%) scale(1) rotate(-360deg);
    }
}

/* Navigation Container - fixed bottom positioning */
.main-nav-container {
    position: fixed;
    bottom: 20px;
    left: 0;
    min-width: 100%;
    z-index: 10000;
    display: flex;

    ul {
        list-style: none;
        padding: 0;
        margin: auto;
        display: flex;
        gap: 10px;
        justify-content: center;
        background: rgba(black, 0.3);
        padding: 5px 10px;
        border-radius: 50px;

        li {
            a {
                color: $color-white;
                font-size: 30px;
                transition: color $transition-fast;
                text-decoration: none;

                &:hover {
                    color: rgba($color-white, 0.3);
                }

                i {
                    display: block;
                }
            }
        }
    }
}

